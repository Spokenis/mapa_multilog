<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mapa de Rotas | Multilog Itajaí</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
        crossorigin=""/>

    <style>
        :root { --multilog-navy: #00113D; --multilog-cyan: #00A99D; --white: #FFFFFF; --light-gray: #f0f2f5; --text-dark: #333; --border-gray: #e0e0e0; }
        body { margin: 0; font-family: 'DM Sans', sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; background-color: var(--light-gray); }
        .container { width: 95%; max-width: 1400px; height: 90vh; display: flex; flex-direction: column; border: 1px solid var(--border-gray); box-shadow: 0 4px 12px rgba(0,0,0,0.08); border-radius: 8px; overflow: hidden; background-color: var(--white); }
        .search-bar { padding: 12px 20px; background-color: var(--white); border-bottom: 1px solid var(--border-gray); display: flex; gap: 15px; align-items: center; flex-wrap: wrap; }
        .logo-container { display: flex; align-items: center; }
        .logo-svg { height: 30px; width: auto; fill: var(--multilog-navy); }
        .search-controls { display: flex; flex-grow: 1; min-width: 280px; }
        #search-input { flex-grow: 1; padding: 10px 15px; border: 1px solid var(--border-gray); border-radius: 6px 0 0 6px; font-size: 1rem; font-family: 'DM Sans', sans-serif; transition: border-color 0.2s ease, box-shadow 0.2s ease; border-right: none; }
        #search-input:focus { outline: none; border-color: var(--multilog-cyan); box-shadow: 0 0 0 2px rgba(0, 169, 157, 0.2); z-index: 2; }
        #search-button { padding: 10px 22px; border: 1px solid var(--multilog-cyan); background-color: var(--multilog-cyan); color: var(--white); font-weight: 500; font-size: 1rem; border-radius: 0 6px 6px 0; cursor: pointer; transition: background-color 0.2s ease; }
        #search-button:hover { background-color: #008a7f; }
        .map-header { padding: 8px 20px; text-align: center; background-color: #fafafa; display: flex; justify-content: space-between; align-items: center; }
        .map-header h1 { margin: 0; font-size: 1.25rem; font-weight: 500; color: var(--text-dark); flex-grow: 1; text-align: center; }
        #print-button { padding: 6px 12px; background-color: transparent; border: 1px solid var(--border-gray); color: var(--text-dark); border-radius: 6px; cursor: pointer; display: flex; align-items: center; gap: 8px; font-size: 0.9rem; transition: background-color 0.2s ease, border-color 0.2s ease; }
        #print-button:hover { background-color: #f0f0f0; border-color: #ccc; }
        #print-button svg { width: 16px; height: 16px; fill: currentColor; }
        #mapa { flex-grow: 1; height: 100%; border-top: 1px solid var(--border-gray); }
    </style>
</head>
<body>
    <div class="container">
        <div class="search-bar">
            <div class="logo-container">
                <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 532.7 151" class="logo-svg" xml:space="preserve"><polygon fill="currentColor" points="363,126.7 394.3,126.7 394.3,139.4 348.6,139.4 348.6,63.3 363,63.3 "/><path fill="currentColor" d="M457.8,117.1c0,12.7-7.3,23.4-28.8,23.4c-21.5,0-28.8-10.7-28.8-23.4V85.6c0-12.7,7.3-23.4,28.8-23.4  c21.5,0,28.8,10.7,28.8,23.4V117.1z M414.6,116.3c0,7.2,3.7,11.5,14.4,11.5c10.7,0,14.4-4.3,14.4-11.5V86.4 c0-7.2-3.7-11.5-14.4-11.5c-10.7,0-14.4,4.3-14.4,11.5V116.3z"/><path fill="currentColor" d="M479.7,115.9c0,7.4,3.2,11.8,13.3,11.8c3.9,0,7.9-0.3,11.8-0.9v-23.1h13.6v33.5c-8,2.3-17.5,3.4-25.5,3.4  c-18.6,0-27.5-7.9-27.5-23V85.1c0-15.7,9.1-23,28.9-23c6.2,0,15,0.7,21.8,2.5l-1.6,12.6c-7-1.5-13.9-2.1-21.4-2.1   c-10.1,0-13.4,4.1-13.4,11.9V115.9z"/><rect x="286.3" y="118.7" fill="currentColor" width="48.4" height="20.8"/><rect x="286.3" y="91" fill="currentColor" width="48.4" height="20.8"/><rect x="286.3" y="63.3" fill="currentColor" width="48.4" height="20.8"/><rect x="286.3" y="35.6" fill="currentColor" width="48.4" height="20.8"/><rect x="286.3" y="7.9" fill="currentColor" width="48.4" height="20.8"/><polygon fill="currentColor" points="62.8,129.6 44.5,129.6 30.4,90.1 29.2,139.4 14.4,139.4 17.9,63.3 34,63.3 53.6,117.3 73.3,63.3   89.4,63.3 92.8,139.4 78.1,139.4 76.8,90.1 "/><path fill="currentColor" d="M155.4,63.3v54.1c0,12-6.7,23.2-28.1,23.2c-21.4,0-28.1-11.2-28.1-23.2V63.3h14.4v52.9    c0,7.4,3.5,11.7,13.7,11.7c10.2,0,13.7-4.2,13.7-11.7V63.3H155.4z"/><polygon fill="currentColor" points="176.9,126.7 208.2,126.7 208.2,139.4 162.4,139.4 162.4,63.3 176.9,63.3 "/><polygon fill="currentColor" points="215.1,76 193.9,76 193.9,63.3 250.8,63.3 250.8,76 229.5,76 229.5,139.4 215.1,139.4 "/><rect x="258" y="63.3" fill="currentColor" width="14.4" height="76.1"/></svg>
            </div>
            <div class="search-controls">
                <input type="text" id="search-input" placeholder="Pesquisar por 'AZ1', 'AZ2', etc.">
                <button id="search-button">Pesquisar</button>
            </div>
        </div>
        <div class="map-header">
            <h1>Itajaí</h1>
            <button id="print-button">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M128 0C92.7 0 64 28.7 64 64v96h64V64H352v96h64V64c0-35.3-28.7-64-64-64H128zM64 352h32c17.7 0 32 14.3 32 32v64c0 17.7-14.3 32-32 32H64c-17.7 0-32-14.3-32-32V384c0-17.7 14.3-32 32-32zm384-32c17.7 0 32 14.3 32 32v64c0 17.7-14.3 32-32 32h-32c-17.7 0-32-14.3-32-32V384c0-17.7 14.3-32 32-32h32zM384 160H128V128H64v32c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V128h-64v32zM160 256c-17.7 0-32 14.3-32 32v64c0 17.7 14.3 32 32 32h192c17.7 0 32-14.3 32-32V288c0-17.7-14.3-32-32-32H160z"/></svg>
                <span>Imprimir</span>
            </button>
        </div>
        <div id="mapa"></div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
        crossorigin=""></script>

    <script>
        const ruas = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
            maxZoom: 19
        });

        const satelite = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
            attribution: 'Tiles &copy; Esri',
            maxZoom: 18
        });
        
        const bounds = L.latLngBounds([
            [-26.958, -48.752], // Sudoeste (ajustado para novas docas)
            [-26.950, -48.748]  // Nordeste (ajustado para novas docas)
        ]);
        
        const mapa = L.map('mapa', {
            center: [-26.9535, -48.7500], // Centralizado nas novas docas
            zoom: 17, // Mais zoom para ver detalhes
            layers: [ruas],
            maxBounds: bounds,
            minZoom: 16 // Aumentado o zoom mínimo
        });

        const baseMaps = {
            "Ruas": ruas,
            "Satélite": satelite
        };

        L.control.layers(baseMaps).addTo(mapa);
        
        const guaritaIcon = L.icon({
            iconUrl: 'guarita.png',
            iconSize:     [38, 38], 
            iconAnchor:   [19, 38], 
            popupAnchor:  [0, -40]
        });

        const docaIcon = L.icon({
            iconUrl: 'doca.png',
            iconSize:     [38, 38],
            iconAnchor:   [19, 38],
            popupAnchor:  [0, -40]
        });

        const startPoint = L.latLng(-26.951650, -48.750924);
        L.marker(startPoint, { icon: guaritaIcon, title: 'Ponto de Partida (Guarita)' }).addTo(mapa);
        
        const docas = [
            { name: "AZ2", coords: L.latLng(-26.956600, -48.750392) },
            { name: "AZ1", coords: L.latLng(-26.954404, -48.750751) },
            { name: "AZ4", coords: L.latLng(-26.951401, -48.749755) },
            { name: "AZ6", coords: L.latLng(-26.951220, -48.749387) }
        ];

        // --- ROTA PARA AZ1 ADICIONADA ---
        const rotasInternas = {
            "AZ1": [
                // Pontos que você forneceu
                [-26.951915, -48.750851], [-26.952299, -48.750753],
                [-26.952617, -48.750508], [-26.952917, -48.750282],
                [-26.953285, -48.749987], [-26.953764, -48.749617],
                 
                [-26.954409, -48.749070], [-26.955072, -48.749066],
                [-26.955522, -48.749109], [-26.955312, -48.749270],
                [-26.955029, -48.749362], [-26.954289, -48.750010]
            ],
            "AZ2": [],
            "AZ4": [],
            "AZ6": []
        };
        // --- FIM DA ROTA ---

        let rotaAtual = null;

        function desenharRota(nomeDoca) {
            if (rotaAtual) { mapa.removeLayer(rotaAtual); }
            
            let coordenadasRota = rotasInternas[nomeDoca];

            if (coordenadasRota && coordenadasRota.length > 0) {
                // Adiciona o ponto de partida e o ponto final para conectar perfeitamente
                const docaInfo = docas.find(d => d.name === nomeDoca);
                const rotaCompleta = [
                    [startPoint.lat, startPoint.lng], 
                    ...coordenadasRota, 
                    [docaInfo.coords.lat, docaInfo.coords.lng]
                ];

                rotaAtual = L.polyline(rotaCompleta, { color: '#00113D', weight: 5, opacity: 0.7 }).addTo(mapa);
                mapa.fitBounds(rotaAtual.getBounds().pad(0.1));
            } else {
                alert(`As coordenadas para a rota até ${nomeDoca} ainda não foram definidas.`);
            }
        }
        
        docas.forEach(doca => {
            const marker = L.marker(doca.coords, { icon: docaIcon, title: doca.name }).addTo(mapa);
            marker.bindPopup(`<b>${doca.name}</b>`);
            marker.on('click', () => { desenharRota(doca.name); });
        });

        const searchInput = document.getElementById('search-input');
        const searchButton = document.getElementById('search-button');
        function performSearch() {
            const query = searchInput.value.trim().toUpperCase(); // Convertido para maiúsculas
            if (!query) return;
            const result = docas.find(doca => doca.name.toUpperCase() === query);
            if (result) {
                desenharRota(result.name);
            } else {
                alert(`Doca não encontrada! Por favor, pesquise por "AZ1", "AZ2", "AZ4" ou "AZ6".`);
            }
        }
        searchButton.addEventListener('click', performSearch);
        searchInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') { searchButton.click(); } });

        const printButton = document.getElementById('print-button');
        printButton.addEventListener('click', () => { window.print(); });
    </script>
</body>
</html>